<!DOCTYPE html>
<html>
<head><title>{{ title }}</title></head>
<body>
    <h1>{{ title }}</h1>
    <p>Total: {{ total_users }} | Ativos: {{ stats.active }}</p>
    
    <form method="get">
        <input name="search" value="{{ search|default:'' }}" placeholder="Buscar...">
        <select name="active">
            <option value="">Todos</option>
            <option value="true" {% if active_filter == 'true' %}selected{% endif %}>Ativos</option>
            <option value="false" {% if active_filter == 'false' %}selected{% endif %}>Inativos</option>
        </select>
        <button>Filtrar</button>
    </form>
    
    <table border="1">
        <tr><th>ID</th><th>Usuário</th><th>Email</th><th>Status</th><th>Ações</th></tr>
        {% for user in users %}
        <tr>
            <td>{{ user.id }}</td>
            <td>{{ user.username }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.is_active|yesno:"Ativo,Inativo" }}</td>
            <td>
                <form method="post" style="display:inline;">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="toggle_active">
                    <input type="hidden" name="user_id" value="{{ user.id }}">
                    <button>{{ user.is_active|yesno:"Desativar,Ativar" }}</button>
                </form>
                <form method="post" style="display:inline;">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="reset_password">
                    <input type="hidden" name="user_id" value="{{ user.id }}">
                    <button>Reset Senha</button>
                </form>
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="5">Nenhum usuário encontrado</td></tr>
        {% endfor %}
    </table>
</body>
</html>
